import{r as a,c as o,n as p,R as d,_ as c,C as m,w as v,$ as g,S as f,h as w,e as b,l as y,z as B,A as S,B as x,D as k,E as C,F as A}from"./iframe-BlCC38XJ.js";import{_ as L}from"./D1List-BgBMp3VF.js";import{B as M,D as V}from"./index-BPfSqOYD.js";import{W as D,D as q}from"./index-Cl5idLwM.js";import{a as _}from"./IconTrailingInclude-Dl0qqbyn.js";import{M as N}from"./ModelInclude-BztEWw6e.js";class T{constructor(e){this.props=e}progress=a(!1);buffer=a();item=o(()=>this.buffer.value??this.props.list??[]);is(){return!!(this.props.ajax||this.props.request)}async preparation(){return await this.update(),!0}async update(){await this.read(e=>this.buffer.value=e)}async getAjax(){return p(this.props.ajax)?d(this.props.ajax):await c.request({path:this.props.ajax,...this.props.request})}async read(e){this.is()&&(this.props.cache&&this.buffer.value!==void 0&&e(this.buffer.value),this.progress.value=!0,e(await this.getAjax()),this.progress.value=!1)}}class I{constructor(e){this.props=e}item=a();value=o(()=>this.props.highlight?this.props.highlight:this.item.value);set(e){const t=this.getValue(e);this.item.value!==t&&(this.item.value=t)}reset(){return this.set(),this}getValue(e){if(m(e))return e.trim()}}class j{constructor(e,t){this.props=e,this.request=t}lite=a();control=a();getExtra(){return{adaptive:"menu",preparation:this.preparation,opening:this.opening,closing:this.closing,role:"menu"}}preparation=async()=>{await this.request.preparation(),this.props.list&&this.props.liteThreshold&&Number(this.props.liteThreshold)<=Object.keys(this.props.list).length&&(this.lite.value=!0)};opening=async()=>(this.lite.value=!1,this.control.value=!0,!0);closing=async()=>(this.lite.value=!1,this.control.value=!1,!0)}class W{constructor(e,t,s){this.props=e,this.refs=t,this.emits=s,this.props.isSelectedByValue&&(new N("selected",this.emits,this.value),t.selected&&v(t.selected,r=>{this.value.value=r},{immediate:!0}))}value=a();selected=o(()=>this.props.isSelectedByValue?this.value.value:this.props.selected);setValue(e,t=!1){return this.props.isSelectedByValue&&!g(e)&&this.value.value!==e&&(this.value.value=e,t&&this.emits?.("updateValue",e)),this}}class F{constructor(e,t,s){this.props=e,this.value=t,this.data=s}previous=()=>this.go(-1);next=()=>this.go(1);getStep(){return Number(this.props.step)||1}go(e){const t=this.data.getSelectedByStep(this.getStep()*e);return t&&this.value.setValue(t,!0),t}}class E{constructor(e,t,s,r,l,h,n,u){this.props=e,this.refs=t,this.element=s,this.classDesign=r,this.className=l,this.components=h,this.slots=n,this.emits=u,this.request=new T(this.props),this.search=new I(this.props),this.value=new W(this.props,this.refs,this.emits),this.data=new f(this.request.item,void 0,void 0,void 0,void 0,this.value.selected,this.refs.keyValue,this.refs.keyLabel),this.go=new F(this.props,this.value,this.data),this.bars=new M(this.props,this.className,this.components,this.emits),this.menuWindow=new j(this.props,this.request),this.window=new D(this.props,this.className,this.components,this.emits,this.menuWindow.getExtra()),this.event=new _(void 0,void 0,this.emits),this.slotData={loading:this.request.progress,isSelected:this.data.isSelected,selectedList:this.data.selectedList,selectedNames:this.data.selectedNames,selectedValues:this.data.selectedValues,previous:this.go.previous,next:this.go.next}}request;search;value;data;go;bars;window;menuWindow;event;slotData;binds=o(()=>({filterMode:this.props.filterMode,liteThreshold:this.props.liteThreshold,keyLabel:this.props.keyLabel,keyValue:this.props.keyValue,max:this.props.max,tag:this.props.tag,onClick:this.onClick,onClose:this.window.expose.toClose,itemAttrs:this.props.itemAttrs,control:!0}));getControlBinds(){return this.slotData}onClick=(e,t)=>{t&&"value"in t&&this.value.setValue(t.value),this.event.onClick(e,t)};onClickSlot=e=>{const t=e.target,s=t.closest("*[data-value]");s&&!t.closest(`.${this.className}__list`)&&this.emits?.("clickSlot",s.dataset.value)}}const H={liteThreshold:40,barsHide:!0,barsBackHide:!0,tag:"a",step:1,autoClose:!0,roleItem:"menuitem"};class $ extends w{item;constructor(e,t,s){super(e,t,s),this.item=new E(this.props,this.refs,this.element,this.getDesign(),this.getName(),this.components,this.slots,this.emits),this.init()}initExpose(){return{...this.item.window.expose,...this.item.getControlBinds()}}initClasses(){return{main:{},bars:this.getSubClass("bars"),list:this.getSubClass("list")}}initStyles(){return{}}initRender(){return this.item.window.render({control:this.renderControl,title:this.renderTitle,default:this.renderList,footer:this.renderFooter},{class:this.classes?.value.main})}renderControl=e=>this.initSlot("control",void 0,this.getBinds(e));renderTitle=e=>{const t=[];return this.item.bars.is.value&&t.push(...this.item.bars.render()),this.initSlot("title",t,this.getBinds(e)),t};renderList=e=>{const t=this.item.request.item.value;if(t){const s=[];return this.initSlot("contextTop",s,this.getBinds(e)),this.props.hideList||s.push(this.components.render("list",b({...this.item.binds.value,class:this.classes?.value.list,selected:this.item.value.selected.value,highlight:this.item.search.value.value,list:t,lite:this.item.menuWindow.lite.value,roleItem:this.props.roleItem},this.props.listAttrs),this.slots)),this.initSlot("contextBottom",s,this.getBinds(e)),y("div",{...this.getAttrs(),ref:this.element,onClick:this.item.onClickSlot},s)}};renderFooter=e=>this.initSlot("footer",void 0,this.getBinds(e));getBinds(e){return{...e,...this.item.getControlBinds()}}}const R=L,U={barsAdaptive:["showAlways","showSm","showMd","showLg","showXl","show2xl"]},X={...H},z=B({name:"D1Menu",__name:"D1Menu",props:S({selected:{type:[Number,String,Boolean,Array]},hideList:{type:Boolean},list:{},liteThreshold:{},highlight:{},highlightLengthStart:{},filterMode:{type:Boolean},ajax:{type:[String,Function]},request:{},cache:{type:Boolean},keyLabel:{},keyValue:{},max:{},tag:{},step:{},listAttrs:{},itemAttrs:{},roleItem:{},isSelectedByValue:{type:Boolean},barsLabel:{},barsDescription:{},barsBackHide:{type:Boolean},barsHide:{type:Boolean},barsList:{},barsAttrs:{},disabled:{type:Boolean},autoClose:{type:Boolean},windowAttrs:{},modelSelected:{},"onUpdate:selected":{type:Function},"onUpdate:modelSelected":{type:Function},barsAdaptive:{}},X),emits:["bars","barsLite","barsBack","click","clickLite","window","update:selected","update:modelSelected","updateValue","clickSlot"],setup(i,{expose:e,emit:t}){const s=t,r=i,l=o(()=>({main:{"d1-menu":!0,"d1-menu--hideList":r.hideList,[`d1-menu--barsAdaptive--${r.barsAdaptive}`]:x(U.barsAdaptive,r.barsAdaptive)}})),h=o(()=>({})),n=new $("d1.menu",r,{emits:s,classes:l,styles:h,components:{list:R,bars:V,window:q}}),u=n.render();return e(n.expose()),(G,O)=>(A(),k(C(u)))}});z.__docgenInfo={name:"D1Menu",exportName:"default",displayName:"D1Menu",description:"",tags:{},props:[{name:"barsAdaptive",required:!1,type:{name:"union",elements:[{name:'"showAlways"'},{name:'"showSm"'},{name:'"showMd"'},{name:'"showLg"'},{name:'"showXl"'},{name:'"show2xl"'}]}},{name:"hideList",required:!1,type:{name:"boolean"}}],sourceFiles:["/Volumes/T7/Code/dxt-ui/packages/d1/src/components/Ui/Menu/D1Menu.vue"]};export{z as _,X as d};
