var h=Object.defineProperty;var u=(e,t,i)=>t in e?h(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var o=(e,t,i)=>u(e,typeof t!="symbol"?t+"":t,i);function m(e){return!!(e&&typeof e=="object")}function g(e,t){if(m(e)){const i=[];return e instanceof Map?e.forEach((r,n)=>i.push(t(r,n,e))):Array.isArray(e)?e.forEach((r,n)=>i.push(t(r,n,e))):Object.entries(e).forEach(([r,n])=>i.push(t(n,r,e))),i.filter(r=>r!==void 0)}return[]}class s{constructor(t){this.item=t}isDocument(){return this.getType()==="DOCUMENT"}isFrame(){return this.getType()==="FRAME"}isSection(){return this.getType()==="SECTION"}isText(){return this.getType()==="TEXT"}isTextNoValue(){if(this.isText()){const t=this.getText();return!(t===""||t.match(/^[\d., ]+(|[^ ]{1,3})$/))}return!1}get(){return this.item}getType(){if("type"in this.item)return this.item.type}getParent(){var t;if("parent"in this.item)return(t=this.item.parent)!=null?t:void 0}getParentItem(){const t=this.getParent();if(t)return new s(t)}getChildren(){return"children"in this.item?this.item.children:[]}getChildrenItems(){return g(this.getChildren(),t=>new s(t))}getId(){return"id"in this.item?this.item.id:""}getName(){return"name"in this.item?this.item.name:this.getId()}async exportJpg(){return await this.exportItem("JPG")}async exportJson(){return await this.exportItem("JSON_REST_V1")}getText(){return this.isText()?this.item.characters.trim():""}getExportSettings(t){switch(t){case"JPG":case"PNG":case"SVG":case"PDF":case"JSON_REST_V1":return{format:t};default:return t}}async exportItem(t){return"exportAsync"in this.item?await this.item.exportAsync(this.getExportSettings(t)):""}}class f{constructor(t){o(this,"items",[]);this.page=t,this.items=this.initItems(t)}getItemsFrame(){return this.filter(t=>t.isFrame())}getItemsSection(){return this.filter(t=>t.isSection())}getItemsText(){return this.filter(t=>t.isText())}getMainFrames(){const t=this.toMain();return t?t.getChildrenItems().filter(i=>i.isFrame()||i.isSection()):[]}getTexts(){const t=[];return this.filter(r=>r.isTextNoValue()).forEach(r=>{const n=r.getText(),a=t.find(c=>c.text===n);a?a.id.push(r.getId()):t.push({id:[r.getId()],text:n})}),t}initItems(t){const i=[];if("children"in t)for(const r of t.children)i.push(new s(r),...this.initItems(r));return i}filter(t){return this.items.filter(t)}toMain(t=new s(this.page)){const i=t.getParentItem();return i&&!i.isDocument()&&this.toMain(i),t}}const l=new f(figma.currentPage);l.getMainFrames().forEach(e=>{e.exportJpg().then(t=>console.log("item",t))});switch(figma.mode){case"inspect":figma.on("selectionchange",()=>{console.log("selection changed",figma.currentPage.selection)}),figma.showUI(__html__);break;case"codegen":figma.codegen.on("generate",async()=>[{title:"Test generate",language:"PLAINTEXT",code:"code test"}]);break}
