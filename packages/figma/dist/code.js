var o=Object.defineProperty;var u=(i,t,e)=>t in i?o(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var h=(i,t,e)=>u(i,typeof t!="symbol"?t+"":t,e);class n{constructor(t){this.item=t}isDocument(){return this.getType()==="DOCUMENT"}isFrame(){return this.getType()==="FRAME"}isSection(){return this.getType()==="SECTION"}isText(){return this.getType()==="TEXT"}isTextNoValue(){if(this.isText()){const t=this.getText();return!(t===""||t.match(/^[\d., ]+(|[^ ]{1,3})$/))}return!1}get(){return this.item}getType(){if("type"in this.item)return this.item.type}getParent(){var t;if("parent"in this.item)return(t=this.item.parent)!=null?t:void 0}getParentItem(){const t=this.getParent();if(t)return new n(t)}getChildren(){return"children"in this.item?this.item.children:[]}getChildrenItems(){const t=[];for(const e of this.getChildren())t.push(new n(e));return t}getId(){return"id"in this.item?this.item.id:""}getName(){return"name"in this.item?this.item.name:this.getId()}async exportJpg(){return await this.exportItem("JPG")}async exportJson(){return await this.exportItem("JSON_REST_V1")}getText(){return this.isText()?this.item.characters.trim():""}getExportSettings(t){switch(t){case"JPG":case"PNG":case"SVG":case"PDF":case"JSON_REST_V1":return{format:t};default:return t}}async exportItem(t){return"exportAsync"in this.item?await this.item.exportAsync(this.getExportSettings(t)):""}}class m{constructor(t){h(this,"items",[]);this.page=t,this.items=this.initBySelection()}getItemsFrame(){return this.filter(t=>t.isFrame())}getItemsSection(){return this.filter(t=>t.isSection())}getItemsText(){return this.filter(t=>t.isText())}getMainFrames(){const t=this.toMain();return t?t.getChildrenItems().filter(e=>e.isFrame()||e.isSection()):[]}getTexts(){const t=[];return this.filter(r=>r.isTextNoValue()).forEach(r=>{const s=r.getText(),a=t.find(c=>c.text===s);a?a.id.push(r.getId()):t.push({id:[r.getId()],text:s})}),t}initItems(t){const e=[];if("children"in t)for(const r of t.children)e.push(new n(r),...this.initItems(r));return e}initBySelection(){if("selection"in this.page){const t=[];for(const e of this.page.selection)t.push(...this.initItems(e));return t}return this.initItems(this.page)}filter(t){return this.items.filter(t)}toMain(t=new n(this.page)){const e=t.getParentItem();return e&&!e.isDocument()&&this.toMain(e),t}}switch(figma.mode){case"inspect":figma.on("selectionchange",()=>{const i=new m(figma.currentPage);console.log("selection changed",i.getTexts())}),figma.showUI(__html__);break;case"codegen":figma.codegen.on("generate",async()=>[{title:"Test generate",language:"PLAINTEXT",code:"code test"}]);break}
