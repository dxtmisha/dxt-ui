// File: component-template.js
var __defProp = Object.defineProperty;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __publicField = (obj, key, value) => __defNormalProp(obj, typeof key !== "symbol" ? key + "" : key, value);
const FIGMA_MESSAGE_CODE = "+)w496um509nu9ue06eu94=vl0efef";
const _FigmaMessage = class _FigmaMessage {
  /**
   * Sends a message from plugin code to UI.
   *
   * Отправляет сообщение из кода плагина в UI.
   * @param type message type/ тип сообщения
   * @param message message data/ данные сообщения
   */
  static post(type, message) {
    figma.ui.postMessage({
      code: this.code,
      type,
      message
    });
  }
  /**
   * Registers a callback handler for a specific message type.
   *
   * Регистрирует обработчик callback для определённого типа сообщения.
   * @param type message type/ тип сообщения
   * @param callback callback function/ функция обратного вызова
   */
  static add(type, callback) {
    const item = this.messages.find((item2) => item2.type === type);
    if (item) {
      item.callbackList.push(callback);
    } else {
      this.messages.push({
        type,
        callbackList: [callback]
      });
    }
  }
  /**
   * Checks if the message code matches the expected code.
   *
   * Проверяет, соответствует ли код сообщения ожидаемому коду.
   * @param code message code/ код сообщения
   */
  static isCode(code) {
    return this.code === code;
  }
  /**
   * Executes all registered callbacks for a specific message type.
   *
   * Выполняет все зарегистрированные обработчики для определённого типа сообщения.
   * @param type message type/ тип сообщения
   * @param message message data/ данные сообщения
   */
  static go(type, message) {
    const item = _FigmaMessage.messages.find((item2) => item2.type === type);
    if (item) {
      item.callbackList.forEach((callback) => callback(message));
    }
  }
};
/**
 * List of registered message handlers/
 * Список зарегистрированных обработчиков сообщений
 */
__publicField(_FigmaMessage, "messages", []);
/**
 * Unique code for message identification/
 * Уникальный код для идентификации сообщений
 */
__publicField(_FigmaMessage, "code", FIGMA_MESSAGE_CODE);
/**
 * Message event handler from the plugin.
 *
 * Обработчик события сообщения от плагина.
 * @param event message event/ событие сообщения
 */
__publicField(_FigmaMessage, "on", (event) => {
  const data = event.data?.pluginMessage;
  if (data && _FigmaMessage.isCode(data.code)) {
    _FigmaMessage.go(
      data.type,
      data.message
    );
  }
});
(() => {
  if (window !== void 0) {
    window.addEventListener("message", _FigmaMessage.on);
  }
})();
let FigmaMessage = _FigmaMessage;
export {
  FigmaMessage
};
//# sourceMappingURL=component-template.js.map
// File: component-template.js.map
{"version":3,"file":"component-template.js","sources":["../src/config.ts","../src/classes/FigmaMessage.ts"],"sourcesContent":["export const FIGMA_IMAGE_TYPE = 'image/jpeg'\n\n/** Figma message code / Код сообщения Figma */\nexport const FIGMA_MESSAGE_CODE = '+)w496um509nu9ue06eu94=vl0efef'\n\n/** Figma message type for texts / Тип сообщения Figma для текстов */\nexport const FIGMA_MESSAGE_TEXTS = 'texts'\n","import type { UiFigmaMessageCallback, UiFigmaMessageData, UiFigmaMessageList } from '../types/figmaTypes'\nimport { FIGMA_MESSAGE_CODE } from '../config'\n\n/**\n * Class for working with messages between Figma plugin code and UI.\n *\n * Класс для работы с сообщениями между кодом плагина Figma и UI.\n */\nexport class FigmaMessage {\n  /**\n   * List of registered message handlers/\n   * Список зарегистрированных обработчиков сообщений\n   */\n  protected static readonly messages: UiFigmaMessageList = []\n\n  /**\n   * Unique code for message identification/\n   * Уникальный код для идентификации сообщений\n   */\n  protected static readonly code: string = FIGMA_MESSAGE_CODE\n\n  /**\n   * Sends a message from plugin code to UI.\n   *\n   * Отправляет сообщение из кода плагина в UI.\n   * @param type message type/ тип сообщения\n   * @param message message data/ данные сообщения\n   */\n  static post<MESSAGE>(\n    type: string,\n    message?: MESSAGE\n  ): void {\n    figma.ui.postMessage({\n      code: this.code,\n      type,\n      message\n    })\n  }\n\n  /**\n   * Registers a callback handler for a specific message type.\n   *\n   * Регистрирует обработчик callback для определённого типа сообщения.\n   * @param type message type/ тип сообщения\n   * @param callback callback function/ функция обратного вызова\n   */\n  static add<T>(\n    type: string,\n    callback: UiFigmaMessageCallback<T>\n  ) {\n    const item = this.messages.find(item => item.type === type)\n\n    if (item) {\n      item.callbackList.push(callback)\n    } else {\n      this.messages.push({\n        type,\n        callbackList: [callback]\n      })\n    }\n  }\n\n  /**\n   * Checks if the message code matches the expected code.\n   *\n   * Проверяет, соответствует ли код сообщения ожидаемому коду.\n   * @param code message code/ код сообщения\n   */\n  protected static isCode(code: string): boolean {\n    return this.code === code\n  }\n\n  /**\n   * Executes all registered callbacks for a specific message type.\n   *\n   * Выполняет все зарегистрированные обработчики для определённого типа сообщения.\n   * @param type message type/ тип сообщения\n   * @param message message data/ данные сообщения\n   */\n  protected static go(\n    type: string,\n    message: any\n  ) {\n    const item = FigmaMessage.messages.find(item => item.type === type)\n\n    if (item) {\n      item.callbackList.forEach(callback => callback(message))\n    }\n  }\n\n  /**\n   * Message event handler from the plugin.\n   *\n   * Обработчик события сообщения от плагина.\n   * @param event message event/ событие сообщения\n   */\n  protected static on = (event: MessageEvent) => {\n    const data: UiFigmaMessageData = event.data?.pluginMessage\n\n    if (\n      data\n      && this.isCode(data.code)\n    ) {\n      this.go(\n        data.type,\n        data.message\n      )\n    }\n  }\n\n  /**\n   * Static initialization block that registers the message listener.\n   *\n   * Статический блок инициализации, который регистрирует слушатель сообщений.\n   */\n  static {\n    if (window !== undefined) {\n      window.addEventListener('message', this.on)\n    }\n  }\n}\n"],"names":["item"],"mappings":";;;AAGO,MAAM,qBAAqB;ACK3B,MAAM,gBAAN,MAAM,cAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAoBxB,OAAO,KACL,MACA,SACM;AACN,UAAM,GAAG,YAAY;AAAA,MACnB,MAAM,KAAK;AAAA,MACX;AAAA,MACA;AAAA,IAAA,CACD;AAAA,EACH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,OAAO,IACL,MACA,UACA;AACA,UAAM,OAAO,KAAK,SAAS,KAAK,CAAAA,UAAQA,MAAK,SAAS,IAAI;AAE1D,QAAI,MAAM;AACR,WAAK,aAAa,KAAK,QAAQ;AAAA,IACjC,OAAO;AACL,WAAK,SAAS,KAAK;AAAA,QACjB;AAAA,QACA,cAAc,CAAC,QAAQ;AAAA,MAAA,CACxB;AAAA,IACH;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,OAAiB,OAAO,MAAuB;AAC7C,WAAO,KAAK,SAAS;AAAA,EACvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,OAAiB,GACf,MACA,SACA;AACA,UAAM,OAAO,cAAa,SAAS,KAAK,CAAAA,UAAQA,MAAK,SAAS,IAAI;AAElE,QAAI,MAAM;AACR,WAAK,aAAa,QAAQ,CAAA,aAAY,SAAS,OAAO,CAAC;AAAA,IACzD;AAAA,EACF;AAgCF;AAAA;AAAA;AAAA;AAAA;AA3GE,cALW,eAKe,YAA+B,CAAA;AAAA;AAAA;AAAA;AAAA;AAMzD,cAXW,eAWe,QAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA6EzC,cAxFW,eAwFM,MAAK,CAAC,UAAwB;AAC7C,QAAM,OAA2B,MAAM,MAAM;AAE7C,MACE,QACG,cAAK,OAAO,KAAK,IAAI,GACxB;AACA,kBAAK;AAAA,MACH,KAAK;AAAA,MACL,KAAK;AAAA,IAAA;AAAA,EAET;AACF;AAAA,CAOA,MAAA;AACE,MAAI,WAAW,QAAW;AACxB,WAAO,iBAAiB,WAAW,cAAK,EAAE;AAAA,EAC5C;AAAA;AA9GG,IAAM,eAAN;"}
