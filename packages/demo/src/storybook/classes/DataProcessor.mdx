import {Meta} from '@storybook/addon-docs/blocks'

<Meta title='@dxtmisha/demo/classes/DataProcessor - Управление и трансформация массивов данных'/>

# Class DataProcessor

Универсальный класс для эффективного управления, фильтрации и преобразования массивов данных. Поддерживает асинхронную загрузку внешних данных и отслеживание состояния выполнения операций.

## Ключевые возможности

- **Асинхронная загрузка** — встроенная поддержка загрузки данных из внешних источников с автоматическим отслеживанием состояния выполнения через флаг `isProcessing`.
- **Гибкая трансформация** — методы для массового обновления, фильтрации и сортировки элементов массива.
- **Удаление дубликатов** — возможность очистки данных от повторов на основе значений или пользовательских ключей.
- **Группировка данных** — мощный инструмент для распределения элементов по категориям на основе селектора ключа.
- **Контроль состояния** — предоставление актуальной статистики о количестве элементов и текущих процессах.

## Методы класса

### `constructor`

Инициализирует экземпляр класса начальным набором данных.

**Параметры:**
- `initialData: T[]` — начальный массив элементов (по умолчанию пустой).

```javascript
const processor = new DataProcessor([{ id: 1, name: 'Item 1' }]);
```

### `loadData`

Асинхронно загружает данные из предоставленного источника и добавляет их к существующим в хранилище. Во время выполнения устанавливает флаг `isProcessing` в `true`.

**Параметры:**
- `source: () => Promise<T[]>` — функция-загрузчик, возвращающая Promise с массивом данных.

**Возвращает:**
`Promise<void>`

```javascript
await processor.loadData(async () => {
  const response = await fetch('/api/data');
  return response.json();
});
```

### `processData`

Преобразует каждый элемент в массиве с помощью функции-процессора.

**Параметры:**
- `processor: (item: T) => T` — функция, принимающая элемент и возвращающая его измененную версию.

```javascript
processor.processData(item => ({ ...item, processed: true }));
```

### `filterData`

Удаляет элементы из массива, которые не соответствуют заданному условию.

**Параметры:**
- `predicate: (item: T) => boolean` — функция для проверки каждого элемента.

```javascript
processor.filterData(item => item.isActive === true);
```

### `sortData`

Сортирует текущие данные на основе предоставленной функции сравнения.

**Параметры:**
- `comparator: (a: T, b: T) => number` — функция, определяющая порядок сортировки.

```javascript
processor.sortData((a, b) => a.id - b.id);
```

### `findItem`

Находит первый элемент, соответствующий заданному условию.

**Параметры:**
- `predicate: (item: T) => boolean` — функция-предикат для поиска.

**Возвращает:**
`T | undefined` — найденный элемент или undefined.

```javascript
const item = processor.findItem(item => item.id === 5);
```

### `distinct`

Удаляет дубликаты из внутреннего хранилища данных.

**Параметры:**
- `keySelector?: (item: T) => any` — опциональная функция для определения уникальности (например, по id).

```javascript
// По значению целиком
processor.distinct();

// По конкретному полю
processor.distinct(item => item.id);
```

### `groupBy`

Группирует элементы массива по ключу, возвращаемому селектором.

**Параметры:**
- `keySelector: (item: T) => string | number` — функция для определения ключа группировки.

**Возвращает:**
`Record<string | number, T[]>` — объект, где ключи — результаты селектора, а значения — массивы соответствующих элементов.

```javascript
const groups = processor.groupBy(item => item.category);
// Результат: { "electronics": [...], "books": [...] }
```

### `exportData`

Возвращает поверхностную копию текущего набора данных.

**Возвращает:**
`T[]` — новый массив с текущими данными.

```javascript
const currentData = processor.exportData();
```

### `clearData`

Полностью очищает внутреннее хранилище данных.

```javascript
processor.clearData();
```

### `getStats`

Возвращает объект с текущей статистикой состояния хранилища.

**Возвращает:**
`{ count: number, processing: boolean }` — объект с количеством элементов и флагом активности процесса загрузки.

```javascript
const { count, processing } = processor.getStats();
console.log(`Элементов: ${count}, Загрузка в процессе: ${processing}`);
```

**Date: 2026-01-06T17:00:33+07:00.**
