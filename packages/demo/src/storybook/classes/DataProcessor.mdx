import {Meta} from '@storybook/addon-docs/blocks'

<Meta title='@dxtmisha/demo/classes/DataProcessor - Универсальный менеджер коллекций данных'/>

# Класс DataProcessor

Универсальный класс для работы с коллекциями данных, обеспечивающий удобный интерфейс для фильтрации, трансформации и управления состоянием массивов. Класс включает в себя механизмы контроля асинхронных операций, что делает его отличным выбором для реализации бизнес-логики списков, таблиц и каталогов.

## Основные возможности

- **Управление состоянием** — встроенный индикатор процесса загрузки для контроля активности асинхронных операций.
- **Иммутабельность при экспорте** — методы возвращают копии данных, защищая внутреннее хранилище от случайных мутаций.
- **Встроенная пагинация** — простой способ получения определенных срезов данных для постраничного отображения.
- **Гибкая трансформация** — поддержка цепочек преобразований через методы фильтрации, сортировки и маппинга.

## Типы данных

### Статистика процессора (Stats)

Объект, возвращаемый методом `getStats`, предоставляющий информацию о текущем наполнении хранилища.

**Свойства:**
- `count: number` — общее количество элементов в массиве.
- `processing: boolean` — активен ли в данный момент процесс загрузки данных.

```javascript
{
  count: 150,
  processing: false
}
```

## Методы

### `constructor`

Инициализирует новый экземпляр процессора данных.

**Параметры:**
- `initialData: T[]` — начальный массив данных (по умолчанию пустой).

```javascript
const processor = new DataProcessor([{ id: 1, name: 'Item 1' }]);
```

### `loadData`

Асинхронно загружает данные из переданного источника и объединяет их с текущим набором. Во время выполнения устанавливает флаг `isProcessing` в значение `true`.

**Параметры:**
- `source: () => Promise<T[]>` — функция, возвращающая промис с массивом элементов.

**Возвращает:** `Promise<void>`

```javascript
await processor.loadData(async () => {
  const result = await api.getItems();
  return result.data;
});
```

### `processData`

Применяет функцию преобразования к каждому элементу коллекции (аналог `map`).

**Параметры:**
- `processor: (item: T) => T` — функция для трансформации элемента.

```javascript
processor.processData(item => ({
  ...item,
  updatedAt: new Date()
}));
```

### `filterData`

Удаляет из коллекции элементы, не соответствующие условию.

**Параметры:**
- `predicate: (item: T) => boolean` — функция-предикат для проверки элементов.

```javascript
processor.filterData(item => item.isActive);
```

### `sortData`

Выполняет сортировку элементов в хранилище на основе функции сравнения.

**Параметры:**
- `comparator: (a: T, b: T) => number` — стандартная функция сравнения элементов.

```javascript
processor.sortData((a, b) => a.priority - b.priority);
```

### `findItem`

Ищет первый элемент, соответствующий заданному условию.

**Параметры:**
- `predicate: (item: T) => boolean` — функция-предикат для поиска.

**Возвращает:** `T | undefined` — найденный объект или `undefined`.

```javascript
const item = processor.findItem(i => i.id === 'target-id');
```

### `getPage`

Возвращает срез данных для организации постраничной навигации.

**Параметры:**
- `page: number` — номер запрашиваемой страницы (начиная с 1).
- `size: number` — количество элементов на одной странице.

**Возвращает:** `T[]` — массив элементов страницы.

```javascript
const secondPage = processor.getPage(2, 10);
```

### `exportData`

Создает и возвращает поверхностную копию текущего набора данных.

**Возвращает:** `T[]` — массив элементов.

```javascript
const currentItems = processor.exportData();
```

### `clearData`

Полностью очищает внутреннее хранилище данных.

```javascript
processor.clearData();
```

### `getStats`

Возвращает статистическую информацию о текущем состоянии процессора.

**Возвращает:** `object` — объект со свойствами `count` и `processing`.

```javascript
const { count, processing } = processor.getStats();
console.log(`Элементов: ${count}, Загрузка: ${processing}`);
```

**Date: 2026-01-06T15:26:34+07:00.**
