import{w as h,r as p,c as o,K as v,o as w,h as x,l,T as S,z as b,A as k,B as g,D as H,E as T,F as C}from"./iframe-BlCC38XJ.js";import{A as u}from"./AriaStaticInclude-BOo8fnl5.js";import{M as P}from"./ModelInclude-BztEWw6e.js";import{T as B,W as M}from"./WindowEsc-DiyFCHzl.js";import{M as y}from"./MotionTransformElement-Bp9F364v.js";class W{constructor(e){this.element=e}top=null;left=null;headWidth=null;height=null;scale=null;contextWidth=null;contextHeight=null;headHeight=null;headScale=null;bodyHeight=null;update(){const e=this.element.getRect();if(e){const t=this.element.getElementHead(),i=this.element.getElementBody(),s=1/window.innerWidth*e.width,a=1/e.width*window.innerWidth;this.top=`${e.top-s*e.top/(s-1)}px`,this.left=`${e.left-s*e.left/(s-1)}px`,this.height=`${100/window.innerHeight*e.height*a}%`,this.scale=s.toString(),this.contextWidth=`${e.width}px`,this.contextHeight=`${e.height}px`,t&&(this.headWidth=`${e.width}px`,this.headHeight=`${t.offsetHeight??"0"}px`,this.headScale=a.toString(),i&&(this.bodyHeight=`${i.offsetHeight+(this.element.isSection()?t.offsetHeight:0)}px`))}}reset(){this.top=null,this.left=null,this.height=null,this.scale=null,this.contextWidth=null,this.contextHeight=null,this.headWidth=null,this.headHeight=null,this.headScale=null,this.bodyHeight=null}}class D{constructor(e,t,i,s){this.element=t,this.tabIndex=i,this.size=s,h([this.element.element,this.show],this.makeShow),h([this.element.element,this.open],this.makeOpen),h([this.element.element,this.teleport],this.makeTeleport),e.open&&requestAnimationFrame(()=>{this.open.value=!!e.open,this.calculations()})}open=p(!1);show=p(!1);teleport=p(!1);isOpen=o(()=>this.open.value);isShow=o(()=>this.open.value||this.show.value);isTeleportClose(){return this.teleport.value&&!this.open.value}set(e,t=!0){this.open.value!==e&&(t&&this.element.isAnimation()?(this.show.value=!0,requestAnimationFrame(()=>{this.calculations(),this.make(),requestAnimationFrame(()=>{this.open.value=e})})):(this.open.value=e,this.calculations()),setTimeout(()=>this.reset(),480))}toggle(){this.set(!this.open.value)}reset(){return this.show.value&&(this.show.value=!1,this.isTeleportClose()&&(this.teleport.value=!1),this.make(),this.tabIndex.toggle(this.open.value)),this}makeShow=()=>{const e=this.element.getElement();e&&(e.dataset.show=this.show.value?"show":"none")};makeOpen=()=>{const e=this.element.getElement();e&&(e.dataset.open=this.open.value?"open":"none")};makeTeleport=()=>{const e=this.element.getElement();e&&(e.dataset.teleport=this.teleport.value?"teleport":"none")};calculations(){this.size.update(),this.toTeleport()}toTeleport(){this.element.isWindow()&&(this.teleport.value=this.isShow.value)}make(){this.makeShow(),this.makeMain(),this.makeContext()}makeMain(){const e=this.element.getElement();if(e){const t=this.element.style;this.show.value?(e.style.setProperty(t.top,this.size.top),e.style.setProperty(t.left,this.size.left),e.style.setProperty(t.height,this.size.height),e.style.setProperty(t.scale,this.size.scale),e.style.setProperty(t.headWidth,this.size.headWidth),e.style.setProperty(t.headHeight,this.size.headHeight),e.style.setProperty(t.headScale,this.size.headScale),e.style.setProperty(t.bodyHeight,this.size.bodyHeight)):(e.style.removeProperty(t.top),e.style.removeProperty(t.left),e.style.removeProperty(t.height),e.style.removeProperty(t.scale),e.style.removeProperty(t.headWidth),e.style.removeProperty(t.headHeight),e.style.removeProperty(t.headScale),e.style.removeProperty(t.bodyHeight))}}makeContext(){const e=this.element.getElementContext();if(e){const t=this.element.style;this.element.isWindow()&&this.isShow.value?(e.style.setProperty(t.contextWidth,this.size.contextWidth),e.style.setProperty(t.contextHeight,this.size.contextHeight)):(e.style.removeProperty(t.contextWidth),e.style.removeProperty(t.contextHeight))}}}class z{constructor(e,t,i,s){this.props=e,this.element=t,this.state=i,this.emits=s,this.item=new v(document.body,"click",this.listener),h(this.state.open,()=>this.item.toggle(this.state.open.value))}item;stop(){return this.item.stop(),this}onClick=e=>{this.props.clickOpen&&this.element.isClick(e.target)&&(this.emit(e,"head"),this.state.toggle())};onTransitionend=e=>{this.element.getElement()===e.target&&e.propertyName==="height"&&this.state.reset()};emit(e,t){const i={type:t,open:!this.state.open.value};this.emits?.("transform",e,i),this.emits?.("transformLite",i)}listener=e=>{const t=e.target;this.state.open.value&&this.element.isClickGlobal(t)&&(this.element.isClose(t)||this.props.autoClose&&this.element.isOutside(t)&&this.element.isIgnore(t))&&(this.emit(e,"body"),this.state.set(!1))}}class O{constructor(e){this.state=e}open=()=>this.state.set(!0);close=()=>this.state.set(!1);toggle=()=>this.state.toggle();to=e=>this.state.set(e)}class E{constructor(e,t,i,s,a,r,m,d,c){this.props=e,this.refs=t,this.classDesign=a,this.className=r,this.components=m,this.slots=d,this.emits=c,this.element=new y(e,i,s,r),this.tabIndex=new B(()=>this.element.getElementBody()),this.size=new W(this.element),this.state=new D(e,this.element,this.tabIndex,this.size),this.event=new z(e,this.element,this.state,c),this.go=new O(this.state),this.esc=new M(this.state.open,()=>this.go.close(),()=>this.element.isWindow()),new P("open",this.emits,this.state.open),h([t.open],()=>this.state.set(!!e.open)),w(()=>this.event.stop())}element;tabIndex;size;state;event;go;esc;slotData=o(()=>({isOpen:this.state.isOpen,isShow:this.state.isShow,classes:y.getClassesList(this.className),idControl:this.element.idControl,idBody:this.element.idBody,binds:u.control(this.element.idControl,this.element.idBody,void 0,this.state.isOpen.value)}));getSlotData(){return this.slotData.value}getRole(){return this.element.isWindow()?"dialog":"region"}}const I={clickOpen:!0,autoClose:!0,animationShow:!0,tagBody:"section",animationHeadPosition:"top"};class A extends x{elementContext=p();item;constructor(e,t,i){super(e,t,i),this.item=new E(this.props,this.refs,this.element,this.elementContext,this.getDesign(),this.getName(),this.components,this.slots,this.emits),this.init()}initExpose(){return{open:this.item.state.open,isShow:this.item.state.isShow,setOpen:this.item.go.to,toOpen:this.item.go.open,toClose:this.item.go.close,toggle:this.item.go.toggle}}initClasses(){return{main:{},context:this.getSubClass("context"),head:this.getSubClass("head"),body:this.getSubClass("body"),backdrop:this.getSubClass("backdrop"),scrim:this.getSubClass("scrim"),clickNone:this.getSubClass("clickNone")}}initStyles(){return{}}initRender(){const e=[...this.renderMain(),...this.renderScrim()];return l("div",{ref:this.elementContext,class:this.classes?.value.context},l(S,{key:"teleport",disabled:!this.item.state.teleport.value,to:"body"},e))}renderMain=()=>[l("div",this.propsMain.value,[...this.renderHead(),...this.renderBody()])];renderHead=()=>[l("div",this.propsHead.value,this.initSlot("head",void 0,this.item.getSlotData()))];renderBody=()=>this.props.inDom||this.item.state.isShow.value?[l(this.props.tagBody??"div",this.propsBody.value,this.initSlot("body",void 0,this.item.getSlotData()))]:[];renderScrim=()=>this.item.state.teleport.value?[l("div",{key:"scrim",class:this.classes?.value.scrim})]:[];propsMain=o(()=>({...this.getAttrs(),ref:this.element,key:"main",class:this.classes?.value.main,onTransitionend:this.item.event.onTransitionend}));propsHead=o(()=>({key:"head",class:this.classes?.value.head,onClick:this.item.event.onClick}));propsBody=o(()=>({key:"body",id:this.item.element.idBody,class:this.classes?.value.body,...u.role(this.item.getRole()),...u.modal(this.item.element.isWindow(),this.props.ariaLabelledby,this.props.ariaDescribedby)}))}const f={animationHeadPosition:["top","toBottom"],adaptive:["planeAlways","planeSm","planeMd","planeLg","planeXl","plane2xl"]},$={...I,animationHeadPosition:"top",adaptive:"planeMd"},_=b({name:"D1MotionTransform",__name:"D1MotionTransform",props:k({open:{type:Boolean},inDom:{type:Boolean},ignore:{},ignoreSelector:{},clickOpen:{type:Boolean},autoClose:{type:Boolean},animationShow:{type:Boolean},tagBody:{},modelOpen:{type:Boolean},"onUpdate:open":{type:Function},"onUpdate:modelOpen":{type:Function},role:{},ariaLabelledby:{},ariaDescribedby:{},section:{type:Boolean},animationHeadPosition:{},adaptive:{}},$),emits:["transform","transformLite","update:open","update:modelOpen"],setup(n,{expose:e,emit:t}){const i=t,s=n,a=o(()=>({main:{"d1-motionTransform":!0,"d1-motionTransform--section":s.section,[`d1-motionTransform--animationHeadPosition--${s.animationHeadPosition}`]:g(f.animationHeadPosition,s.animationHeadPosition),[`d1-motionTransform--adaptive--${s.adaptive}`]:g(f.adaptive,s.adaptive)}})),r=o(()=>({})),m=new A("d1.motionTransform",s,{emits:i,classes:a,styles:r}),d=m.render();return e(m.expose()),(c,F)=>(C(),H(T(d)))}});_.__docgenInfo={name:"D1MotionTransform",exportName:"default",displayName:"D1MotionTransform",description:"",tags:{},props:[{name:"adaptive",required:!1,type:{name:"union",elements:[{name:'"planeAlways"'},{name:'"planeSm"'},{name:'"planeMd"'},{name:'"planeLg"'},{name:'"planeXl"'},{name:'"plane2xl"'}]}},{name:"animationHeadPosition",required:!1,type:{name:"union",elements:[{name:'"top"'},{name:'"toBottom"'}]}},{name:"section",required:!1,type:{name:"boolean"}}],sourceFiles:["/Volumes/T7/Code/dxt-ui/packages/d1/src/components/Ui/MotionTransform/D1MotionTransform.vue"]};export{_,$ as d};
