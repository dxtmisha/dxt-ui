import{w as m,r,c as p,B as f,x as v,k as w,h as a,J as S,f as x,m as k,g as u,j as H,l as T,u as P,o as C}from"./iframe-CpPdPYqc.js";import{M as g}from"./MotionTransformElement-FRbw_Xpg.js";import{M as b}from"./ModelInclude-BqNOWDx8.js";class M{constructor(e){this.element=e}top=null;left=null;headWidth=null;height=null;scale=null;contextWidth=null;contextHeight=null;headHeight=null;headScale=null;bodyHeight=null;update(){const e=this.element.getRect();if(e){const t=this.element.getElementHead(),i=this.element.getElementBody(),s=1/window.innerWidth*e.width,n=1/e.width*window.innerWidth;this.top=`${e.top-s*e.top/(s-1)}px`,this.left=`${e.left-s*e.left/(s-1)}px`,this.height=`${100/window.innerHeight*e.height*n}%`,this.scale=s.toString(),this.contextWidth=`${e.width}px`,this.contextHeight=`${e.height}px`,t&&(this.headWidth=`${e.width}px`,this.headHeight=`${t.offsetHeight??"0"}px`,this.headScale=n.toString(),i&&(this.bodyHeight=`${i.offsetHeight+(this.element.isSection()?t.offsetHeight:0)}px`))}}reset(){this.top=null,this.left=null,this.height=null,this.scale=null,this.contextWidth=null,this.contextHeight=null,this.headWidth=null,this.headHeight=null,this.headScale=null,this.bodyHeight=null}}class B{constructor(e,t,i){this.element=t,this.size=i,m([this.element.element,this.open],this.makeOpen),m([this.element.element,this.teleport],this.makeTeleport),e.open&&requestAnimationFrame(()=>{this.open.value=!!e.open,this.calculations()})}open=r(!1);show=r(!1);teleport=r(!1);isOpen=p(()=>this.open.value);isShow=p(()=>this.open.value||this.show.value);isTeleportClose(){return this.teleport.value&&!this.open.value}set(e,t=!0){this.open.value!==e&&(t&&this.element.isAnimation()?(this.show.value=!0,requestAnimationFrame(()=>{this.calculations(),this.make(),requestAnimationFrame(()=>{this.open.value=e})})):(this.open.value=e,this.calculations()),setTimeout(()=>this.reset(),480))}toggle(){this.set(!this.open.value)}reset(){return this.show.value&&(this.show.value=!1,this.isTeleportClose()&&(this.teleport.value=!1),this.make()),this}makeShow=()=>{const e=this.element.getElement();e&&(e.dataset.show=this.show.value?"show":"none")};makeOpen=()=>{const e=this.element.getElement();e&&(e.dataset.open=this.open.value?"open":"none")};makeTeleport=()=>{const e=this.element.getElement();e&&(e.dataset.teleport=this.teleport.value?"teleport":"none")};calculations(){this.size.update(),this.toTeleport()}toTeleport(){this.element.isWindow()&&(this.teleport.value=this.isShow.value)}make(){this.makeShow(),this.makeMain(),this.makeContext()}makeMain(){const e=this.element.getElement();if(e){const t=this.element.style;this.show.value?(e.style.setProperty(t.top,this.size.top),e.style.setProperty(t.left,this.size.left),e.style.setProperty(t.height,this.size.height),e.style.setProperty(t.scale,this.size.scale),e.style.setProperty(t.headWidth,this.size.headWidth),e.style.setProperty(t.headHeight,this.size.headHeight),e.style.setProperty(t.headScale,this.size.headScale),e.style.setProperty(t.bodyHeight,this.size.bodyHeight)):(e.style.removeProperty(t.top),e.style.removeProperty(t.left),e.style.removeProperty(t.height),e.style.removeProperty(t.scale),e.style.removeProperty(t.headWidth),e.style.removeProperty(t.headHeight),e.style.removeProperty(t.headScale),e.style.removeProperty(t.bodyHeight))}}makeContext(){const e=this.element.getElementContext();if(e){const t=this.element.style;this.element.isWindow()&&this.isShow.value?(e.style.setProperty(t.contextWidth,this.size.contextWidth),e.style.setProperty(t.contextHeight,this.size.contextHeight)):(e.style.removeProperty(t.contextWidth),e.style.removeProperty(t.contextHeight))}}}class z{constructor(e,t,i,s){this.props=e,this.element=t,this.state=i,this.emits=s,this.item=new f(document.body,"click",this.listener),m(this.state.open,()=>this.item.toggle(this.state.open.value))}item;stop(){return this.item.stop(),this}onClick=e=>{this.props.clickOpen&&this.element.isClick(e.target)&&(this.emit(e,"head"),this.state.toggle())};onTransitionend=e=>{this.element.getElement()===e.target&&e.propertyName==="height"&&this.state.reset()};emit(e,t){const i={type:t,open:!this.state.open.value};this.emits?.("transform",e,i),this.emits?.("transformLite",i)}listener=e=>{const t=e.target;this.state.open.value&&this.element.isClickGlobal(t)&&(this.element.isClose(t)||this.props.autoClose&&this.element.isOutside(t)&&this.element.isIgnore(t))&&(this.emit(e,"body"),this.state.set(!1))}}class W{constructor(e){this.state=e}open=()=>this.state.set(!0);close=()=>this.state.set(!1);toggle=()=>this.state.toggle();to=e=>this.state.set(e)}class O{constructor(e,t,i,s,n,l,h,c,d){this.props=e,this.refs=t,this.classDesign=n,this.className=l,this.components=h,this.slots=c,this.emits=d,this.element=new g(e,i,s,l),this.size=new M(this.element),this.state=new B(e,this.element,this.size),this.event=new z(e,this.element,this.state,d),this.go=new W(this.state),new b("open",this.emits,this.state.open),m([t.open],()=>this.state.set(!!e.open)),v(()=>this.event.stop())}element;size;state;event;go;getSlotData(){return{isOpen:this.state.isOpen,isShow:this.state.isShow,classes:g.getClassesList(this.className)}}}const D={clickOpen:!0,autoClose:!0,animationShow:!0,animationHeadPosition:"top"};class E extends w{elementContext=r();item;constructor(e,t,i){super(e,t,i),this.item=new O(this.props,this.refs,this.element,this.elementContext,this.getDesign(),this.getName(),this.components,this.slots,this.emits),this.init()}initExpose(){return{open:this.item.state.open,isShow:this.item.state.isShow,setOpen:this.item.go.to,toOpen:this.item.go.open,toClose:this.item.go.close,toggle:this.item.go.toggle}}initClasses(){return{main:{},context:this.getSubClass("context"),head:this.getSubClass("head"),body:this.getSubClass("body"),backdrop:this.getSubClass("backdrop"),scrim:this.getSubClass("scrim"),clickNone:this.getSubClass("clickNone")}}initStyles(){return{}}initRender(){const e=[...this.renderMain(),...this.renderScrim()];return a("div",{ref:this.elementContext,class:this.classes?.value.context},a(S,{key:"teleport",disabled:!this.item.state.teleport.value,to:"body"},e))}renderMain=()=>[a("div",{...this.getAttrs(),ref:this.element,key:"main",class:this.classes?.value.main,onTransitionend:this.item.event.onTransitionend},[...this.renderHead(),...this.renderBody()])];renderHead=()=>[a("div",{key:"head",class:this.classes?.value.head,onClick:this.item.event.onClick},this.initSlot("head",void 0,this.item.getSlotData()))];renderBody=()=>this.item.state.isShow.value?[a("div",{key:"body",class:this.classes?.value.body},this.initSlot("body",void 0,this.item.getSlotData()))]:[];renderScrim=()=>this.item.state.teleport.value?[a("div",{key:"scrim",class:this.classes?.value.scrim})]:[]}const y={animationHeadPosition:["top","toBottom"],adaptive:["planeAlways","planeSm","planeMd","planeLg","planeXl","plane2xl"]},$={...D,animationHeadPosition:"top",adaptive:"planeMd"},_=x({name:"D1MotionTransform",__name:"D1MotionTransform",props:k({open:{type:Boolean},ignore:{},ignoreSelector:{},clickOpen:{type:Boolean},autoClose:{type:Boolean},animationShow:{type:Boolean},modelOpen:{type:Boolean},"onUpdate:open":{type:Function},"onUpdate:modelOpen":{type:Function},section:{type:Boolean},animationHeadPosition:{},adaptive:{}},$),emits:["transform","transformLite","update:open","update:modelOpen"],setup(o,{expose:e,emit:t}){const i=t,s=o,n=p(()=>({main:{"d1-motionTransform":!0,"d1-motionTransform--section":s.section,[`d1-motionTransform--animationHeadPosition--${s.animationHeadPosition}`]:u(y.animationHeadPosition,s.animationHeadPosition),[`d1-motionTransform--adaptive--${s.adaptive}`]:u(y.adaptive,s.adaptive)}})),l=p(()=>({})),h=new E("d1.motionTransform",s,{emits:i,classes:n,styles:l}),c=h.render();return e(h.expose()),(d,A)=>(C(),H(T(P(c))))}});_.__docgenInfo={name:"D1MotionTransform",exportName:"default",displayName:"D1MotionTransform",description:"",tags:{},props:[{name:"adaptive",required:!1,type:{name:"union",elements:[{name:'"planeAlways"'},{name:'"planeSm"'},{name:'"planeMd"'},{name:'"planeLg"'},{name:'"planeXl"'},{name:'"plane2xl"'}]}},{name:"animationHeadPosition",required:!1,type:{name:"union",elements:[{name:'"top"'},{name:'"toBottom"'}]}},{name:"section",required:!1,type:{name:"boolean"}}],sourceFiles:["/Volumes/T7/Git/dxt-ui/packages/d1/src/components/Ui/MotionTransform/D1MotionTransform.vue"]};export{_,$ as d};
