import{r as u,c as s,e as f,w,V as c,ag as v,C as I,a9 as B,$ as y,ah as M,ai as A,f as d,g as b,aj as p,x as F,h as E,l as T,z as C,A as D,D as S,E as V,F as N}from"./iframe-BlCC38XJ.js";import{F as g,_ as O}from"./D1Mask-BZr7U_zp.js";import{_ as P}from"./D1Field-CZWXxD_d.js";import{M as _}from"./ModelInclude-BztEWw6e.js";class H{item=u(!1);constructor(t){(t.value||t.modelValue)&&(this.item.value=!0)}is(){return!!this.item.value}set(t){this.item.value=t}to(){this.item.value||this.set(!0)}}class L{item=u(!1);toggle(){return this.item.value=!this.item.value,this}}class R{constructor(t,e){this.props=t,this.visibility=e}item=s(()=>{const t=this.props.type;return t==="password"&&this.visibility?.item.value?"text":t??"text"});get(){return this.item.value}}const q={email:"[\\S]+@[\\S]{2,}\\.[\\w]{2,}",password:"[0-9a-zA-Z\\-!@#$%^&*]+"};class j{constructor(t,e){this.props=t,this.type=e}item=s(()=>{if(this.props.pattern)return this.props.pattern;if(this.type)return q?.[this.type.item.value]})}class z{constructor(t,e){this.props=t,this.type=e}item=s(()=>{if(this.props.inputMode)return this.props.inputMode;switch(this.type.item.value){case"number":case"datetime":case"date":case"year-month":case"time":case"hour-minute":return"numeric";case"number-format":case"currency":return"decimal";case"tel":return"tel";case"email":return"email";default:return}})}class G{constructor(t,e,i,a){this.props=t,this.type=e,this.pattern=i,this.inputMode=a}list=s(()=>this.getData(this.getAttributes()));listForCheck=s(()=>{const t=this.list.value;return this.props.min||this.props.max||this.props.step?{...t,type:"number"}:t});listForInput=s(()=>this.getData(this.getInputAttributes()));getAttributes(){return["type","name","required","multiple","step","min","max","minlength","maxlength","accept","pattern"]}getInputAttributes(){return[...this.getAttributes(),"list","placeholder","readonly","disabled","autofocus","tabindex","form","autocomplete","autocapitalize","inputMode","enterKeyHint","spellcheck","autocorrect"]}getData(t){const e={};return t.forEach(i=>{let a;if(i in this.props)switch(i){case"type":this.type?a=this.type.item.value:a=this.props.type;break;case"pattern":this.pattern&&(a=this.pattern.item.value);break;case"inputMode":this.inputMode&&(a=this.inputMode.item.value);break;default:a=this.props[i]}a!==void 0&&(e[i]=a)}),f(e,this.props.inputAttrs)}}class ${constructor(t,e){this.props=t,this.element=e}get(){const t=this.element.value;if(t)return"input"in t?t.input:t}getElement(){return this.element}findByName(t){if(t instanceof Element)return t;const e=this.get()?.form;if(e){const a=e.querySelector(`[name="${t}"]`);if(a)return a}const i=document.querySelector(t);if(i)return i}clear(){const t=this.element.value;return t&&"clear"in t&&t.clear?.(),this}}class U{constructor(t,e,i,a){this.props=t,this.refs=e,this.element=i,this.original=a,this.item.value=this.getOriginal(),w([e.value,e.modelValue],this.update)}item=u();isFull=u(!0);hasEdit=u(!1);is=s(()=>this.hasEdit.value||this.boolean.value||!!this.props.placeholder);isValue=s(()=>this.hasEdit.value||this.boolean.value);itemByFull=s(()=>this.isFull.value?this.item.value:void 0);number=s(()=>this.boolean.value?c(this.string.value):0);string=s(()=>v(this.item.value));boolean=s(()=>I(this.item.value));length=s(()=>{const t=this.item.value;return B(t)?t.length:y(t)?Object.keys(t).length:this.string.value.length??0});get(){return this.item.value}getToArray(){return M(this.item.value)}set(t){if(this.isDifference(t)){this.item.value=A(this.item.value,t,{multiple:this.props.multiple,maxlength:c(this.props.maxlength)});const e=this.element?.getElement();e&&e.value&&"setValue"in e.value&&e.value?.setValue(this.item.value)}return this}setByEvent(t){switch(console.log("setByEvent"),typeof t){case"object":t&&("value"in t&&t.value!==void 0?this.set(t.value):"target"in t&&this.setByTarget(t.target),"hasEdit"in t&&this.setHasEdit(t.hasEdit),"isFull"in t&&this.setFull(t.isFull));break;default:this.set(t);break}return this}setByTarget(t){return this.set(this.isCheckbox(t)?t.checked:t.value)}setByChecked(t){const e=t.target;return this.set(e.checked)}setByRadio(t){const e=t.target,i=e.checked?e.value:"";return this.set(i)}setFull(t){this.isFull.value=t}setHasEdit(t){this.hasEdit.value=t}setToOriginal(){return this.item.value=this.getOriginal(),this}clear(){return this.item.value=d(this.original),this.element?.clear(),this.hasEdit.value=!1,this.isFull.value=!0,this}isCheckbox(t){return t.type==="checkbox"}isDifference(t=this.getOriginal()){return this.string.value!==v(t)}getOriginal(){return this.props.value||this.props.modelValue||d(this.original)}update=()=>{(this.isEdit(this.props.value)||this.isEdit(this.props.modelValue))&&this.setToOriginal()};isEdit(t){return t!==void 0&&v(t)!==this.string.value}}class K{constructor(t,e,i){this.props=t,this.value=e,this.type=i}is=s(()=>!!(this.props.arrow&&this.props.arrow!=="none"));disabledPrevious=s(()=>!this.isPrevious(this.value.number.value));disabledNext=s(()=>!this.isNext(this.value.number.value));step=s(()=>c(this.props.arrowStep??this.props.step??1));min=s(()=>c(this.props.min)??void 0);max=s(()=>c(this.props.max)||void 0);isCarousel(){return this.get()==="carousel"}isStepper(){return this.get()==="stepper"}isPrevious(t){const e=this.min.value;return e===void 0||t>e}isNext(t){const e=this.max.value;return e===void 0||t<e}get(){switch(this.props.arrow){case"auto":if(this.type?.get()==="number"||this.type?.get()==="number-format")return"stepper";break}return this.props.arrow}align(){return this.props.arrowAlign}previous(){const t=this.value.number.value-this.step.value;return this.isPrevious(t)?this.value.set(t.toString()):this.toMin(),this}next(){const t=this.value.number.value+this.step.value;return this.isNext(t)?this.value.set(t.toString()):this.toMax(),this}toMin(){if(!this.disabledPrevious.value){const t=this.min.value;t!==void 0&&this.value.set(t.toString())}return this}toMax(){if(!this.disabledNext.value){const t=this.max.value;t!==void 0&&this.value.set(t.toString())}return this}}class Z{constructor(t,e){this.props=t,this.visibility=e}visible=!1;is=s(()=>this.props.type==="password");icon=s(()=>{if(this.is.value)return{active:this.visibility.item.value,icon:this.props.iconVisibilityOff,iconActive:this.props.iconVisibility,dynamic:!0}});toggle(){this.is.value&&this.visibility.toggle()}}class J{constructor(t,e,i,a){this.props=t,this.element=e,this.value=i,this.text=a}is(){return!!this.props.match}getSelectors(){if(this.is())return y(this.props.match)?this.props.match.name:this.props.match}getValidationMessage(){if(this.is()){if(y(this.props.match)&&this.props.match?.validationMessage)return this.props.match.validationMessage;if(this.text)return this.text.entriesMatch.value??""}return""}check(){const t=this.getSelectors();if(t){const e=this.element.findByName(t);if(e&&v(e.value)!==this.value.string.value)return{group:g.getGroupDefault(),status:!1,input:this.element.get(),validationMessage:this.getValidationMessage(),value:this.value.item.value}}}}class Q{constructor(t){this.props=t}get(t){const e=this.props.validationCode;if(t&&e&&!t.valid){if(typeof e=="string")return e;{const i=this.getIndex(t);if(i&&i in e)return e[i]}}}getIndex(t){const e=Object.entries(t);for(const[i,a]of e)if(i!=="valid"&&a)return i}}class W{constructor(t,e,i,a,n,o){this.props=t,this.attributes=e,this.value=i,this.change=a,this.code=n,this.match=o}validation=u();input=s(()=>new g(this.attributes.listForCheck.value,void 0,this.code));item=s(()=>{const t=this.checkGlobal();if(t)return t;const e=this.checkItem()??this.match?.check();return e||this.getValidationItemNone()});message=s(()=>{if(this.props.validationMessage)return this.props.validationMessage;if(!this.change||this.change.is()){const t=this.item.value;return t.validityMessage??t.validationMessage??""}return""});isError(){return!this.item.value?.status}checkValidity=()=>!this.isError();set(t){return"status"in t&&"validationMessage"in t&&"value"in t?this.validation.value=t:"target"in t&&(t.target instanceof HTMLInputElement||t.target instanceof HTMLTextAreaElement)&&Number(t.target.minLength)>-1?this.validation.value=this.input.value.checkByInput(t.target):this.validation.value=void 0,this}getValidationItemNone(){return{group:g.getGroupDefault(),status:!0,value:void 0}}checkGlobal(){return this.props.validationMessage?{group:g.getGroupDefault(),status:!1,validationMessage:this.props.validationMessage,value:this.value.item.value}:this.validation.value??void 0}checkItem(){const t=this.value.getToArray();for(const e of t){const i=this.checkByInput(e);if(!i.status)return i}}checkByInput(t){return this.input.value.check(t)}}class X{constructor(t,e,i,a,n){this.props=t,this.change=e,this.value=i,this.validation=a,this.emits=n,this.model=new _("value",this.emits,this.value.itemByFull)}model;onBlur=()=>{this.change.to()};onInput=(t,e)=>{if(this.isEnabled()){const i=e??t;(this.change.is()||e)&&this.validation?.set(i),this.value.setByEvent(i),this.on(t)}};onChange=t=>{this.isEnabled()&&(t&&this.validation?.set(t),this.change.to(),this.on(t,"change"))};onSelect=(t,e)=>{this.isEnabled()&&(this.value.setByEvent(e??t),this.onAndChange(t))};onChecked=t=>{this.isEnabled()&&(this.value.setByChecked(t),this.onAndChange(t))};onRadio=t=>{this.isEnabled()&&(this.value.setByRadio(t),this.onAndChange(t))};onClear=t=>{this.isEnabled()&&(this.value.clear(),this.onAndChange(t))};onValue=t=>{this.isEnabled()&&(this.value.set(t),this.onAndChange())};on=(t,e="input")=>(e==="input"&&this.model.emit(this.value.itemByFull.value),this.emits?.(e,t,{...this.getValidation(e),...this.getData()}),this);isValue(t){return!!(t&&["input","change"].indexOf(t)>=0)}isEnabled(){return this.props.disabled!==!0}getData(){return{value:this.value.itemByFull.value,valueInput:this.value.item.value,detail:this.props.detail}}getValidation(t){return this.isValue(t)?this.validation?this.validation.item.value:{group:"check",value:this.value.item.value}:{}}onAndChange(t){return this.on(t).onChange(t),this}}class Y{constructor(t,e,i,a,n,o,l,h,m,k,x){this.props=t,this.value=e,this.components=i,this.event=a,this.arrow=n,this.onIcon=o,this.onTrailing=l,this.onNext=h,this.onPrevious=m,this.extra=k,this.index=x}binds=s(()=>f({focus:this.props.focus,selected:this.props.selected,readonly:this.props.readonly,disabled:this.props.disabled,loading:this.props.loading,forceShowMessage:this.props.forceShowMessage,label:this.props.label,prefix:this.props.prefix,suffix:this.props.suffix,caption:this.props.caption,helperMessage:this.props.helperMessage,required:this.props.required,detail:this.props.detail,cancel:this.props.cancel,counterShow:this.props.counterShow,icon:this.props.icon,iconTurn:this.props.iconTurn,iconHide:this.props.iconHide,iconDir:this.props.iconDir,iconPalette:this.props.iconPalette,iconTrailing:this.props.iconTrailing,iconTrailingTurnOnly:this.props.iconTrailingTurnOnly,iconTrailingDirOnly:this.props.iconTrailingDirOnly,iconTrailingPalette:this.props.iconTrailingPalette,iconAttrs:this.props.iconAttrs,align:this.props.align,arrowCarousel:this.arrow?.isCarousel()??this.props.arrow==="carousel",arrowStepper:this.arrow?.isStepper()??this.props.arrow==="stepper",arrowAlign:this.arrow?.align()??this.props.arrowAlign,isSkeleton:this.props.isSkeleton,fieldLabelAttrs:this.props.fieldLabelAttrs,fieldMessageAttrs:this.props.fieldMessageAttrs,fieldCounterAttrs:this.props.fieldCounterAttrs,onClick:this.on},d(this.extra),this.props.fieldAttrs));valueBinds=s(()=>({...this.binds.value,isValue:this.value.is.value,value:this.value.item.value,cancelShow:this.value.boolean.value,counter:this.value.length.value,disabledPrevious:this.arrow?.disabledPrevious.value,disabledNext:this.arrow?.disabledNext.value}));render=(t,e)=>this.components?this.components.render("field",b(this.valueBinds.value,e??{}),t,this.index):[];on=(t,{type:e})=>{if(t.target.closest('[data-element="scoreboard"]'))switch(e){case"icon":this.onIcon?.(),p(t);break;case"icon-trailing":this.onTrailing?.(),p(t);break;case"cancel":this.event?.onClear(t),p(t);break;case"next":this.onNext?.(),this.arrow?.next(),this.event?.on(t),p(t);break;case"previous":this.onPrevious?.(),this.arrow?.previous(),this.event?.on(t),p(t);break}}}class tt{constructor(t,e,i,a,n,o,l,h){this.props=t,this.className=e,this.value=i,this.valueDefault=a,this.components=n,this.type=o,this.extra=l,this.index=h,this.value&&w(this.is,m=>{m||this.value.setFull(!0)})}is=s(()=>{const t=this.type?.get();return this.props.maskNone!==!0&&!!(this.props.mask||t&&["number","number-format","currency","datetime","date","year-month","time","hour-minute"].indexOf(t)!==-1)});bindsStatic=s(()=>{const t=b(d(this.extra)??{},this.props.maskAttrs??{});return{name:this.props.name,valueDefault:d(this.valueDefault),currency:this.props.currency,currencyHide:this.props.currencyHide,fraction:this.props.fraction,type:this.type?.get(),visible:this.props.maskVisible,...F(this.props.mask,t,"mask")}});binds=s(()=>({...this.bindsStatic.value,value:this.props.modelValue??this.props.value}));render=t=>this.components?this.components.render("mask",{...b(t??{},this.binds.value)},void 0,this.index):[];isActive(){return this.is.value}}class et{constructor(t,e,i,a,n,o,l,h){this.props=t,this.refs=e,this.element=i,this.classDesign=a,this.className=n,this.components=o,this.slots=l,this.emits=h,this.change=new H(this.props),this.visibility=new L,this.type=new R(this.props,this.visibility),this.pattern=new j(this.props,this.type),this.inputMode=new z(this.props,this.type),this.attributes=new G(this.props,this.type,this.pattern,this.inputMode),this.elementItem=new $(this.props,this.element),this.value=new U(this.props,this.refs,this.elementItem),this.arrow=new K(this.props,this.value,this.type),this.password=new Z(this.props,this.visibility),this.match=new J(this.props,this.elementItem,this.value),this.code=new Q(this.props),this.validation=new W(this.props,this.attributes,this.value,this.change,this.code,this.match),this.event=new X(this.props,this.change,this.value,this.validation,this.emits),this.field=new Y(this.props,this.value,this.components,this.event,this.arrow,void 0,()=>this.password.toggle(),void 0,void 0,s(()=>({iconTrailing:this.password.icon.value??this.props.iconTrailing,maxlength:this.props.maxlength??this.props.max}))),this.mask=new tt(this.props,this.className,this.value,"",this.components,this.type)}visibility;type;pattern;inputMode;attributes;elementItem;change;value;arrow;password;match;code;validation;event;field;mask}const it={type:"text",autocomplete:"off",arrow:"auto",maskVisible:!0};class st extends E{item;constructor(t,e,i){super(t,e,i),this.item=new et(this.props,this.refs,this.element,this.getDesign(),this.getName(),this.components,this.slots,this.emits),this.init()}initExpose(){return{value:this.item.value.item,checkValidity:this.item.validation.checkValidity,validationMessage:this.item.validation.message}}initClasses(){return{main:{}}}initStyles(){return{}}initRender(){return this.item.field.render({default:this.renderInput},{...this.getAttrs(),class:this.classes?.value.main,validationMessage:this.item.validation.message.value})}renderInput=t=>this.item.mask.isActive()?this.renderMask(t):[T("input",f(this.item.attributes.listForInput.value,t.binds,{ref:this.element,value:this.item.value.item.value,onBlur:this.item.event.onBlur,onInput:this.item.event.onInput,onChange:this.item.event.onChange}))];renderMask=t=>this.item.mask.render({ref:this.element,class:t.className,align:this.props.align,inputAttrs:f(this.item.attributes.listForInput.value,t.binds),onBlur:this.item.event.onBlur,onInput:this.item.event.onInput})}const at=O,rt=P,nt={...it,iconVisibility:"visibility",iconVisibilityOff:"visibility_off"},ot=C({name:"D1Input",__name:"D1Input",props:D({name:{},mask:{},maskVisible:{type:Boolean},maskNone:{type:Boolean},currency:{},currencyHide:{type:Boolean},fraction:{type:[String,Boolean,Number]},maskAttrs:{},focus:{type:Boolean},selected:{type:Boolean},readonly:{type:Boolean},disabled:{type:Boolean},align:{},cancel:{},fieldAttrs:{},id:{},iconTrailing:{},iconTrailingTurnOnly:{type:Boolean},iconTrailingDirOnly:{type:Boolean},iconTrailingPalette:{type:Boolean},iconTurn:{type:Boolean},iconHide:{type:Boolean},iconDir:{type:Boolean},iconPalette:{type:Boolean},iconAttrs:{},icon:{},prefix:{},suffix:{},caption:{},required:{type:Boolean},fieldLabelAttrs:{},label:{},labelId:{},counterShow:{type:Boolean},counterId:{},fieldCounterAttrs:{},forceShowMessage:{type:Boolean},helperMessage:{},validationMessage:{},fieldMessageAttrs:{},helperId:{},validationId:{},loading:{type:[Boolean,Object]},detail:{},isSkeleton:{type:Boolean},list:{},iconVisibility:{},iconVisibilityOff:{},type:{},autofocus:{type:Boolean},tabindex:{},form:{},validationCode:{},match:{},inputAttrs:{},placeholder:{},value:{},modelValue:{},"onUpdate:value":{type:Function},"onUpdate:modelValue":{type:Function},step:{},min:{},max:{},arrow:{},arrowStep:{},arrowAlign:{},minlength:{},maxlength:{},pattern:{},autocomplete:{},autocapitalize:{},inputMode:{},enterKeyHint:{},spellcheck:{type:[Boolean,String]},autocorrect:{}},nt),emits:["update:value","update:modelValue","input","inputLite","change","changeLite"],setup(r,{expose:t,emit:e}){const i=e,a=r,n=s(()=>({main:{"d1-input":!0}})),o=s(()=>({})),l=new st("d1.input",a,{emits:i,classes:n,styles:o,components:{mask:at,field:rt}}),h=l.render();return t(l.expose()),(m,k)=>(N(),S(V(h)))}});ot.__docgenInfo={name:"D1Input",exportName:"default",displayName:"D1Input",description:"",tags:{},sourceFiles:["/Volumes/T7/Code/dxt-ui/packages/d1/src/components/Ui/Input/D1Input.vue"]};export{rt as D,G as F,ot as _,H as a,$ as b,U as c,nt as d,Q as e,W as f,X as g,Y as h};
